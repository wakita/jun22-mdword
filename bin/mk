#!/bin/sh

PATH=$HOME/.cabal/bin:$PATH
step=$1
step=${step:=final}

case $step in
  v0) # いきなりテキストファイルを処理
    parameters=(
    --from markdown
    doc/constitution.txt);;

  v1) # Markdown化
    parameters=(
    --from markdown
    doc/constitution.md);;

  v2) # 目次の追加
    parameters=(
    --from markdown+pandoc_title_block
    --number-sections
    doc/constitution.md
    --table-of-contents lib/pandoc-ja.yaml);;
    
  # スタイリング
  v3 | final)
    parameters=(
    --from markdown+pandoc_title_block
    --number-sections
    doc/constitution.md
    --table-of-contents lib/pandoc-ja.yaml
    --reference-docx=lib/constitution-templ.docx);;

  v*)
    echo "Usage: $0 {v[0123]}"
    exit 1;;
esac

cmdline="pandoc$EXE -t docx -o constitution-$step.docx --standalone ${parameters[@]}"
echo $cmdline
$cmdline
